{% extends "base.html" %}
{% block title %}Community Groups{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2 class="h5 mb-0">Find, join & discuss with football groups</h2>
  <a class="btn btn-success btn-sm" href="{% url 'community:create_group' %}">+ New Group</a>
</div>

<input id="js-group-search" type="text" class="form-control mb-3" placeholder="Search groupsâ€¦">

<div class="row g-3" id="js-group-list">
  {% for g in groups %}
    <div class="col-12">
      <div class="card shadow-sm border-0">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-start">
            <div>
              <h3 class="h6 mb-1">{{ g.name }}</h3>
              {% if g.description %}
                <p class="text-muted small mb-2">{{ g.description|truncatechars:140 }}</p>
              {% endif %}
              <span class="badge text-bg-light">{{ g.posts.count }} posts</span>
            </div>
            <a class="btn btn-primary btn-sm" href="{% url 'community:group_detail' g.slug %}">Open</a>
          </div>
        </div>
      </div>
    </div>
  {% empty %}
    <div class="col-12">
      <div class="alert alert-light border">No groups yet. Create the first one!</div>
    </div>
  {% endfor %}
</div>
{% endblock %}

{% block extra_js %}
<script>
  // tiny client-side filter for the list page only
  const q = document.getElementById('js-group-search');
  const cards = [...document.querySelectorAll('#js-group-list .card')];
  q?.addEventListener('input', () => {
    const needle = q.value.toLowerCase();
    cards.forEach(c => {
      const text = c.textContent.toLowerCase();
      c.parentElement.style.display = text.includes(needle) ? '' : 'none';
    });
  });
</script>
{% endblock %}
